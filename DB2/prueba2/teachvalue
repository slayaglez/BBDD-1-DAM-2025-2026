CREATE TABLE IF NOT EXISTS "users" (
	"id_users" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" VARCHAR(255),
	"email" VARCHAR(255),
	PRIMARY KEY("id_users")
);




CREATE TABLE IF NOT EXISTS "groups" (
	"id_groups" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" VARCHAR(255) NOT NULL,
	"purpose" VARCHAR(255),
    "created_in" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY("id_groups")
);




CREATE TABLE IF NOT EXISTS "users_groups" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"id_users_fk" INTEGER,
	"id_groups_fk" INTEGER,
	"user_balance" REAL NOT NULL DEFAULT 0,
	"id_expenses_fk" INTEGER,
	PRIMARY KEY("id")
);




CREATE TABLE IF NOT EXISTS "expenses" (
	"id_expenses" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	"amount" REAL NOT NULL,
	"created_by_fk" INTEGER NOT NULL,
	"description" VARCHAR(255),
	"currency" VARCHAR(255),
	PRIMARY KEY("id_expenses")
);



ALTER TABLE "users_groups"
ADD FOREIGN KEY("id_users_fk") REFERENCES "users"("id_users")
ON UPDATE NO ACTION ON DELETE NO ACTION;
ALTER TABLE "users_groups"
ADD FOREIGN KEY("id_groups_fk") REFERENCES "groups"("id_groups")
ON UPDATE NO ACTION ON DELETE NO ACTION;
ALTER TABLE "expenses"
ADD FOREIGN KEY("created_by_fk") REFERENCES "users"("id_users")
ON UPDATE NO ACTION ON DELETE NO ACTION;
ALTER TABLE "users_groups"
ADD FOREIGN KEY("id_expenses_fk") REFERENCES "expenses"("id_expenses")
ON UPDATE NO ACTION ON DELETE NO ACTION;

INSERT INTO users(name, email)
VALUES
('Johan', 'johanjohan@sample.com'),
('JuanPabloxx', 'skillstopcanarias@ganador.es'),
('Somilinator', 'xxsomilxx@sample.com');

INSERT INTO groups(name, purpose)
VALUES
('Supernenes', 'Botellon');


INSERT INTO expenses (amount, description, currency, created_by)
VALUES
('34.90', 'cita romantica', 'francos suizos', '1');


INSERT INTO users_groups (id_users_fk, id_groups_fk, id_expenses_fk, user_balance)
VALUES
(1, 1, 3, 17.45),
(2, 1, 3, -17.45);

INSERT INTO expenses (amount, description, currency, created_by)
VALUES
('60.90', 'infidelidad en la bolera', 'francos suizos', '2');


INSERT INTO users_groups (id_users_fk, id_groups_fk, id_expenses_fk, user_balance)
VALUES
(3, 1, 2, -30.45),
(2, 1, 2, 30.45);
